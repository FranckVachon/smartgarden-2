import java.util.Random

/**
 * initialiser divers états de nos items .
 */

rule "Initialiser les verrous"
when
    System started
then
    verrous.sendCommand(ON)
end


rule "Initialiser les gicleurs"
when
    System started
then
    gicleurs.sendCommand(OFF)
end


rule "Initialiser les détecteurs de mouvement"
when
    System started
then
    gDetecteursMouvements.members.forEach(detector|detector.sendCommand(OFF))  
end


rule "Initialiser les températures de la piscine"
when
    System started
then
    logInfo("Info", "Initialiser les températures de la piscine.")
    temp_piscine_actuelle.sendCommand(17.5)
    temp_piscine_desiree.sendCommand(22)
end


rule "Turn on lights when detected movement"
when
    Item mouvement_nord_ouest changed from OFF to ON or
	Item mouvement_sud_ouest changed from OFF to ON or
	Item mouvement_sud_est changed from OFF to ON or
	Item mouvement_nord_est changed from OFF to ON or
	Item mouvement_est changed from OFF to ON
then
	var nightTimeStart = 1600
	var nightTimeEnd = 0530
	var currentTime = now.getHourOfDay * 100 + now.getMinuteOfHour

	if (currentTime >= nightTimeStart || currentTime <= nightTimeEnd) {
        // Nighttime
        lumieres.sendCommand(ON)
	}
	else {
        // Daytime
	}
end


rule "Turn off sprinklers when detected movement or door unlock"
when
    Item mouvement_nord_ouest changed from OFF to ON or
    Item mouvement_sud_ouest changed from OFF to ON or
    Item mouvement_sud_est changed from OFF to ON or
    Item mouvement_nord_est changed from OFF to ON or
    Item mouvement_est changed from OFF to ON or
    Item verrous_porte_exterieure changed from ON to OFF
then
    gicleurs.sendCommand(OFF)
end







